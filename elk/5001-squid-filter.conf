filter {
	if [type] == "squid" {
	    # http://wiki.squid-cache.org/Features/LogFormat#squid
	    grok {
	        match => {"message" => "%{NUMBER:time} +%{NUMBER:elapsed} %{IPORHOST:remotehost} %{WORD:code}/%{NUMBER:status} %{NUMBER:bytes} (%{URIPROTO:http_proto}://)?%{IPORHOST2:dst_host}(?::%{POSINT:port})?(?:%{NOTSPACE:uri_param})?"}
	        named_captures_only => true
	    }
	    #if [dst_ip] {
    	#	geoip {
      	#		source => "dst_ip"
      	#		target => "dst_geoip"
      	#		database => "/usr/share/GeoIP/GeoLiteCity.dat"
    	#		fields => [ "country_code2", "country_name" ]
    	#	}
  		#}
	}
}
